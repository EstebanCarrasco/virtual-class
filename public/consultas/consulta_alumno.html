<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Consulta Alumno</title>
    <link rel="stylesheet" href="styleconsulta.css">
</head>
<body>
    <h1>Consulta Alumno</h1>
        
<br>
<br>


<form>
    <textarea class=estilotextarea id="planteo" cols="30" rows="8" placeholder="Realiza Consulta . . ."></textarea> 

</form>

<br>
<input class="botons" type="submit" value="Enviar" onclick="enviarConsulta()">
<input class="botons" type="submit" value="Adjuntar Archivo">
<input class="botons" type="submit" value="Comprar Horas">
<br>
<br>
<br>
<br>
<br>
<br>
   <p><a href="/index.html">Regresar</a></p>

</body>

<script>
    async function obtenerDatos() {
        const token = localStorage.getItem('token');
        if(token) { 
            const respuesta = await fetch('/api/users/verifyToken', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': token
                }
            })

            const datos = await respuesta.json();
            console.log(datos)
        }
    }

    obtenerDatos();

    async function enviarConsulta(e) {
         //Obtener Id de la URL
        const token = localStorage.getItem('token');

        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        const planteo = document.getElementById("planteo").value;
        const body = {
            profesor: id,
            planteo
        }

        const respuesta = await fetch('/api/users/consulta', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': token
                },
                body: JSON.stringify(body)
            })

        console.log(body)
        alert('Consulta enviada')
    }
</script>
</html>